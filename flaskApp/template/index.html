<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <script
      type="text/javascript"
      src="https://code.jquery.com/jquery-3.4.1.min.js"
    ></script>
    <script type="text/javascript">
      $(function () {
        $("#upload-file-btn").click(function () {
          console.log($("#upload-file")[0]);
          var form_data = new FormData($("#upload-file")[0]);
          console.log(form_data);
          $.ajax({
            type: "POST",
            url: "http://127.0.0.1:5000/api/v1/csvToBvh",
            data: form_data,
            contentType: false,
            cache: false,
            processData: false,
            success: function (data) {
              console.log(data);
              //Convert the Byte Data to BLOB object.
              var blob = new Blob([data], { type: "application/octetstream" });

              //Check the Browser type and download the File.
              var isIE = false || !!document.documentMode;
              if (isIE) {
                window.navigator.msSaveBlob(blob, "sample.bvh");
              } else {
                var url = window.URL || window.webkitURL;
                link = url.createObjectURL(blob);
                var a = $("<a />");
                a.attr("download", "sample.bvh");
                a.attr("href", link);
                $("body").append(a);
                a[0].click();
                $("body").remove(a);
              }
              window.location.href =
                "http://lo-th.github.io/olympe/BVH_player.html";
            },
          });
        });
      });
    </script>
  </head>
  <body>
    <h2>Please upload your input CSV data to convert into animation file</h2>
    <dl>
      <form id="upload-file" method="post" enctype="multipart/form-data">
        <fieldset>
          <label for="file">Select a file</label>
          <input name="file" type="file" />
        </fieldset>
        <fieldset>
          <button id="upload-file-btn" type="button">Upload</button>
        </fieldset>
      </form>
    </dl>
  </body>
</html>
